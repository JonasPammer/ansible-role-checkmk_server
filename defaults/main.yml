---
# defaults file of ansible-role jonaspammer.checkmk_server
# See README.adoc for documentation. If you change a default here, also update it in the README.

checkmk_site_url: "http://localhost/{{ checkmk_server_site }}"
checkmk_server_site: "main"

# INSTALL
checkmk_server_prerequisites: "{{
  _checkmk__server_prerequisites[ansible_distribution ~ '_' ~ ansible_distribution_major_version]|default(
  _checkmk__server_prerequisites[ansible_os_family ~ '_' ~ ansible_distribution_major_version])|default(
  _checkmk__server_prerequisites[ansible_distribution])|default(
  _checkmk__server_prerequisites[ansible_os_family])|default(
  _checkmk__server_prerequisites['default']) }}"
checkmk_server_install_cache_valid_time: "3600"

# NOTE: When updating manually, do not forget to
#       also update version in checkmk_agent role!!
# ===== BEGIN generate_yaml MANAGED SECTION

_checkmk_server_download_checksum:
  Debian_bullseye: sha1:c99c530424c9aca96ee642ffa99d8045fe412414
  Debian_buster: sha1:6f296b09e2fe923c944b3887e7a9389739697ae3
  Debian_stretch: sha1:f769bf65768d64410f9f5f8839d4102c3a054a5b
  RedHat_7: sha1:b85f09088d0e04043b5a3b531af338ccb0ef2be6
  RedHat_8: sha1:5d834efe252cfde8122bc536b978bc44779eb5f7
  RedHat_9: None
  Ubuntu_bionic: sha1:e2980a356cd4c4ed09d8deb733ed3d4f61fdf5b6
  Ubuntu_focal: sha1:49138fa70290244ee1c6081d1997dcb1f4b380ad
  Ubuntu_hirsute: None
  Ubuntu_impish: None
  Ubuntu_jammy: sha1:368c778f168c9a0777ab91f5303c89eab591ed5f
  Ubuntu_xenial: sha1:44184911922c5f8df0dd91617a655f50e4dbc942
checkmk_server_version: 2.0.0p28

# ===== END generate_yaml MANAGED SECTION
checkmk_server_download_checksum: "{{
  _checkmk_server_download_checksum[ansible_distribution ~ '_' ~ ansible_distribution_release]|default(
  _checkmk_server_download_checksum[ansible_distribution ~ '_' ~ ansible_distribution_major_version])|default(
  _checkmk_server_download_checksum[ansible_os_family ~ '_' ~ ansible_distribution_major_version])|default(
  _checkmk_server_download_checksum[ansible_distribution])|default(
  _checkmk_server_download_checksum[ansible_os_family])|default(
  _checkmk_server_download_checksum['default']) }}"
checkmk_server_download_package: "{{
  _checkmk__server_download_package[ansible_distribution ~ '_' ~ ansible_distribution_major_version]|default(
  _checkmk__server_download_package[ansible_os_family ~ '_' ~ ansible_distribution_major_version])|default(
  _checkmk__server_download_package[ansible_distribution])|default(
  _checkmk__server_download_package[ansible_os_family])|default(
  _checkmk__server_download_package['default']) }}"
checkmk_server_download_url: "https://download.checkmk.com/checkmk/{{ checkmk_server_version }}/{{ checkmk_server_download_package }}"
checkmk_server_download_pubkey_url: "https://download.checkmk.com/checkmk/Check_MK-pubkey.gpg"
checkmk_server_download_dest: "{{ checkmk_server_download_dest_folder }}/{{ checkmk_server_download_package }}"
checkmk_server_download_dest_folder: "/opt"
checkmk_server_download_mode: u=rw,g=r,o=r

checkmk_server_man_mode: u=rwx,g=rx,o=rx
checkmk_server_man_path: "/usr/share/man/man8"

checkmk_server_omd_setup_command: "omd setup"
checkmk_server_omd_setup_creates: "/opt/omd"

# SITE CREATION
checkmk_server_omd_create_command: "omd create {{ checkmk_server_site }}"
checkmk_server_omd_create_creates: "/opt/omd/sites/{{ checkmk_server_site }}"
checkmk_server_log_dest: "/opt/omd/sites/{{ checkmk_server_site }}/omd-create.log"
checkmk_server_log_group: "{{ checkmk_server_site }}"
checkmk_server_log_mode: "u=rw,g=,o="
checkmk_server_log_owner: "{{ checkmk_server_site }}"

checkmk_server_htpasswd_group: "{{ checkmk_server_site }}"
checkmk_server_htpasswd_mode: u=rw,g=rw,o= # pragma: allowlist secret
checkmk_server_htpasswd_name: "cmkadmin" # pragma: allowlist secret
checkmk_server_htpasswd_owner: "{{ checkmk_server_site }}"
checkmk_server_htpasswd_path: "/opt/omd/sites/{{ checkmk_server_site }}/etc/htpasswd"

checkmk_server_omd_start_command: "omd start {{ checkmk_server_site }}"
checkmk_server_omd_start_creates: "/opt/omd/sites/{{ checkmk_server_site }}/tmp/apache/run/apache.pid"

checkmk_apache_service: "{{ apache__service|default(
  _checkmk__apache_service[ansible_distribution ~ '_' ~ ansible_distribution_release])|default(
  _checkmk__apache_service[ansible_distribution ~ '_' ~ ansible_distribution_major_version])|default(
  _checkmk__apache_service[ansible_os_family ~ '_' ~ ansible_distribution_major_version])|default(
  _checkmk__apache_service[ansible_distribution])|default(
  _checkmk__apache_service[ansible_os_family])|default(
  _checkmk__apache_service['default']) }}"

# CONFIG
checkmk_server_omd_config_show_command: "omd config {{ checkmk_server_site }} show {{ item.var }}"
checkmk_server_omd_config_set_command: "omd config {{ checkmk_server_site }} set {{ item.var }} {{ item.val }}"

checkmk_server_omd_stop_command: "omd stop {{ checkmk_server_site }}"
checkmk_server_omd_stop_changed_when: '"killing" in __register.stdout'

checkmk_server_site_conf: true

## General
checkmk_server_site_conf_admin_mail: ""
checkmk_server_site_conf_autostart: "on"
checkmk_server_site_conf_core: nagios
checkmk_server_site_conf_tmpfs: "on"

## Web GUI
checkmk_server_site_conf_apache_mode: own
checkmk_server_site_conf_apache_tcp_addr: 127.0.0.1
checkmk_server_site_conf_apache_tcp_port: 5000
checkmk_server_site_conf_multisite_authorisation: "on"
checkmk_server_site_conf_multisite_cookie_auth: "on"
checkmk_server_site_conf_nagios_theme: classicui

## Addons
checkmk_server_site_conf_mkeventd: "on"
checkmk_server_site_conf_mkeventd_snmptrap: "off"
checkmk_server_site_conf_mkeventd_syslog: "off"
checkmk_server_site_conf_mkeventd_syslog_tcp: "off"
checkmk_server_site_conf_pnp4nagios: "on"

## Distributed Monitoring (most important to alter)
checkmk_server_site_conf_livestatus_tcp: "off"
checkmk_server_site_conf_ncsa: "off"
